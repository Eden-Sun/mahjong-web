<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>éŠæˆ²ç‹€æ…‹è¨ºæ–·</title>
<style>
body {
  font-family: monospace;
  padding: 20px;
  background: #f0f0f0;
}
pre {
  background: white;
  padding: 15px;
  border-radius: 8px;
  overflow-x: auto;
}
button {
  padding: 10px 20px;
  margin: 10px 5px;
  font-size: 16px;
  cursor: pointer;
}
.status {
  margin: 10px 0;
  padding: 10px;
  border-radius: 4px;
}
.ok { background: #d4edda; border: 1px solid #28a745; }
.error { background: #f8d7da; border: 1px solid #dc3545; }
.warning { background: #fff3cd; border: 1px solid #ffc107; }
</style>
</head>
<body>
<h1>ğŸ” éº»å°‡éŠæˆ²è¨ºæ–·å·¥å…·</h1>

<div>
  <button onclick="checkGameState()">æª¢æŸ¥éŠæˆ²ç‹€æ…‹</button>
  <button onclick="checkCSS()">æª¢æŸ¥ CSS è¼‰å…¥</button>
  <button onclick="checkButtons()">æª¢æŸ¥æŒ‰éˆ•ç‹€æ…‹</button>
  <button onclick="location.href='/'">è¿”å›éŠæˆ²</button>
</div>

<div id="output"></div>

<script>
function log(html) {
  document.getElementById('output').innerHTML += html;
}

function checkGameState() {
  log('<h2>éŠæˆ²ç‹€æ…‹æª¢æŸ¥</h2>');
  
  // å˜—è©¦å¾ window ç²å–éŠæˆ²ç‹€æ…‹
  const checks = [
    { name: 'gameState', value: window.gameState },
    { name: 'gameController', value: window.gameController },
    { name: 'selectTileå‡½æ•¸', value: typeof window.selectTile === 'function' }
  ];
  
  checks.forEach(check => {
    const status = check.value ? 'ok' : 'error';
    log(`<div class="status ${status}">âœ“ ${check.name}: ${check.value ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}</div>`);
  });
  
  if (window.gameState) {
    log('<h3>éŠæˆ²éšæ®µè³‡è¨Š</h3>');
    log(`<pre>${JSON.stringify({
      gamePhase: window.gameState.gamePhase,
      currentPlayerIdx: window.gameState.currentPlayerIdx,
      waitingForResponse: window.gameState.waitingForResponse,
      playerHandSize: window.gameState.players[0]?.hand?.length
    }, null, 2)}</pre>`);
  }
}

function checkCSS() {
  log('<h2>CSS æª¢æŸ¥</h2>');
  
  const sheets = Array.from(document.styleSheets);
  log(`<div class="status ok">è¼‰å…¥äº† ${sheets.length} å€‹æ¨£å¼è¡¨</div>`);
  
  // æª¢æŸ¥æ˜¯å¦æœ‰ mobile-optimized.css çš„è¦å‰‡
  let foundMobileRules = false;
  sheets.forEach((sheet, idx) => {
    try {
      const rules = Array.from(sheet.cssRules || []);
      const hasMobileRules = rules.some(rule => 
        rule.cssText && rule.cssText.includes('button.hand-tile-button')
      );
      if (hasMobileRules) {
        foundMobileRules = true;
        log(`<div class="status ok">âœ“ æ¨£å¼è¡¨ ${idx}: åŒ…å« mobile-optimized è¦å‰‡</div>`);
      }
    } catch(e) {
      // CORS é™åˆ¶ï¼Œç„¡æ³•è®€å–
    }
  });
  
  if (!foundMobileRules) {
    log(`<div class="status warning">âš  æœªæ‰¾åˆ° mobile-optimized.css è¦å‰‡ï¼ˆå¯èƒ½è¢« CORS é™åˆ¶ï¼‰</div>`);
  }
}

function checkButtons() {
  log('<h2>æŒ‰éˆ•ç‹€æ…‹æª¢æŸ¥</h2>');
  
  const buttons = document.querySelectorAll('button.hand-tile-button');
  log(`<div class="status ${buttons.length > 0 ? 'ok' : 'error'}">æ‰¾åˆ° ${buttons.length} å€‹æ‰‹ç‰ŒæŒ‰éˆ•</div>`);
  
  if (buttons.length > 0) {
    buttons.forEach((btn, idx) => {
      const isDisabled = btn.disabled;
      const hasOnclick = btn.onclick !== null;
      const pointerEvents = window.getComputedStyle(btn).pointerEvents;
      const zIndex = window.getComputedStyle(btn).zIndex;
      
      log(`<div class="status ${isDisabled ? 'error' : 'ok'}">
        æŒ‰éˆ• ${idx + 1}: 
        disabled=${isDisabled}, 
        onclick=${hasOnclick}, 
        pointer-events=${pointerEvents},
        z-index=${zIndex}
      </div>`);
    });
  }
}

// è‡ªå‹•åŸ·è¡Œæª¢æŸ¥
setTimeout(() => {
  if (window.location.pathname === '/debug.html') {
    checkGameState();
    checkCSS();
    checkButtons();
  }
}, 500);
</script>
</body>
</html>
